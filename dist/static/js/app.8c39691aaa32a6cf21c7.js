webpackJsonp([1],[,,,,,,,,,,,function(e,t,a){function o(e){a(48)}var n=a(0)(a(16),a(57),o,"data-v-378b888d",null);e.exports=n.exports},function(e,t,a){function o(e){a(49)}var n=a(0)(a(15),a(58),o,null,null);e.exports=n.exports},,function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=a(6),n=a(12),r=a.n(n);o.a.config.productionTip=!1;var s=a(13);s.registerCustomEvent("doubletap",{type:"tap",taps:2}),o.a.use(s),new o.a({el:"#app",template:"<App/>",data:{firebaseApp:!1,database:!1,user:!1,provider:!1,state:{doubletap:!0}},components:{App:r.a},mounted:function(){var e={apiKey:"AIzaSyCZOGNAh0h4zhmEshF-ExSQtVjJO8z8Loo",authDomain:"shade-dev.firebaseapp.com",databaseURL:"https://shade-dev.firebaseio.com",projectId:"shade-dev",storageBucket:"shade-dev.appspot.com",messagingSenderId:"91667937762"};this.firebaseApp=firebase.initializeApp(e),this.database=this.firebaseApp.database(),this.provider={google:new firebase.auth.GoogleAuthProvider,facebook:new firebase.auth.FacebookAuthProvider}}})},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=a(54),n=a.n(o),r=a(56),s=a.n(r),i=a(55),u=a.n(i);t.default={name:"app",data:function(){return{isConnect:!1,user:!1,profilPage:!1,flowPage:!1}},components:{pageConnect:n.a,pageProfil:s.a,pageFlow:u.a}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={name:"footerMenu",data:function(){return{}},methods:{goToProfil:function(){var e=this.$parent.$parent;e.flowPage=!1,e.profilPage=!0},goToFlow:function(){var e=this.$parent.$parent;e.profilPage=!1,e.flowPage=!0}}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={name:"pageConnect",methods:{facebook:function(){var e=this,t=e.$parent.$parent,a=e.$parent;t.provider.facebook.setCustomParameters({display:"popup"}),t.provider.facebook.addScope("email"),firebase.auth().signInWithPopup(t.provider.facebook).then(function(e){var t=(e.credential.accessToken,e.user);firebase.database().ref("/users/"+t.uid).once("value").then(function(e){null==e.val()?firebase.database().ref("/users/"+t.uid).set({username:t.displayName,mail:t.email,isPhoto:!1}).then(function(){console.log("new user",name,"created"),a.isConnect=!0,a.profilPage=!0,a.user=t}):(console.log("compte déjà en db"),console.log(a.isConnect),a.isConnect=!0,a.profilPage=!0,a.user=t)})})}}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=a(7),n=a.n(o),r=a(11),s=a.n(r);t.default={name:"pageFlow",components:{footerMenu:s.a},data:function(){return{user:this.$parent.user,picturesUrl:[]}},methods:{like:function(e){var t=firebase.database().ref("photos/"),a=e.target.currentSrc;t.orderByChild("url").equalTo(a).once("value").then(function(e){var t=e.val();console.log("sensé etre un object",t);var a=n()(t);console.log("id",a[0]);var o=n()(t).map(function(e){return[Number(e),t[e]]});console.log("est devenu un array",o);var r=o.map(function(e){return e[1].like});r++,console.log("count",r);var s={};s["photos/"+a[0]+"/like"]=r,firebase.database().ref().update(s)})}},created:function(){var e=this;firebase.database().ref("photos/").on("value",function(t){var a=t.val(),o=[];a&&(n()(a).map(function(e){return[Number(e),a[e]]}).map(function(e){o.push(e[1].url)}),e.picturesUrl=o)})}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=a(7),n=a.n(o),r=a(20),s=a.n(r),i=(a(6),a(11)),u=a.n(i);t.default={name:"pageProfil",components:{footerMenu:u.a},data:function(){return{user:this.$parent.user,imageUrl:!1,image:!1,isPhoto:!1,msg:{a:!1,b:"Postez une photo"},myPhoto:!1,classId:!1,active:!0}},methods:{test:function(){console.log("tap")},removePhoto:function(){console.log(event.currentTarget);var e=(event.currentTarget.parentElement.parentElement,event.currentTarget.getAttribute("class")),t=e.split(" ");firebase.database().ref("photos/"+t[2]).remove()},flowPage:function(){this.$parent.flowPage=!0,this.$parent.profilPage=!1},onFileChange:function(e){var t=e.target.files||e.dataTransfer.files;t.length&&this.createImage(t[0])},createImage:function(e){var t=(new Image,new FileReader),a=this;console.log(e),t.onload=function(e){a.imageUrl=e.target.result},a.image=e,this.uploadImage()},removeImage:function(e){this.image=""},uploadImage:function(){var e=this,t=e.image,a=t;console.log(a.lastModified),firebase.storage().ref(s()(a.lastModified)).put(a).then(function(e){console.log("Uploaded a blob or file!")}).then(function(){var t=firebase.storage().ref(s()(a.lastModified)),o=void 0;!function(){t.getDownloadURL().then(function(e){var t=new XMLHttpRequest;t.responseType="blob",t.onload=function(e){t.response},t.open("GET",e),t.send(),o=e,n(o)}).catch(function(e){console.log(e)})}();var n=function(){var t={a:"plop",b:"plop2",c:"plop3"},a={a:"random"},n=firebase.database().ref("photos/").push({url:o,wtacherId:t,category:a,userId:e.user.uid,like:0,pushId:0}),r=n.key,s={};s["photos/"+r+"/pushId"]=r,firebase.database().ref().update(s);var i={};i["users/"+e.user.uid+"/isPhoto"]=!0,firebase.database().ref().update(i),e.removeImage(),e.isPhoto=!0,console.log(e.msg),e.msg.a="Photo bien recu",e.msg.b="Poster d'autre photos"}})}},created:function(){var e=this;firebase.database().ref("users/"+e.user.uid).on("value",function(t){e.isPhoto=!0,firebase.database().ref("photos/").orderByChild("userId").equalTo(e.user.uid).on("value",function(t){var a=t.val(),o=[];a&&(n()(a).map(function(e){return[Number(e),a[e]]}).map(function(e){o.push(e[1])}),e.myPhoto=o)})})}}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},,function(e,t,a){function o(e){a(50)}var n=a(0)(a(17),a(59),o,"data-v-52675f9d",null);e.exports=n.exports},function(e,t,a){function o(e){a(51)}var n=a(0)(a(18),a(60),o,"data-v-7278c18b",null);e.exports=n.exports},function(e,t,a){function o(e){a(52)}var n=a(0)(a(19),a(61),o,"data-v-c702ab4e",null);e.exports=n.exports},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("form",[a("nav",[a("ul",[a("li",{attrs:{id:"profil"}},[a("figure",{staticClass:"icon-user",on:{click:function(t){t.preventDefault(),e.goToProfil(t)}}})]),e._v(" "),a("li",[a("button",{on:{click:function(e){e.preventDefault()}}})])])])])},staticRenderFns:[]}},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"app"}},[e.isConnect?e._e():a("page-connect"),e._v(" "),e.profilPage?a("page-profil"):e._e(),e._v(" "),e.flowPage?a("page-flow"):e._e()],1)},staticRenderFns:[]}},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("main",[a("div",{staticClass:"container"},[a("a",{staticClass:"btn",on:{click:function(t){t.preventDefault(),e.facebook(t)}}},[e._v("\n        Se connecter avec Facebook")])])])},staticRenderFns:[]}},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("main",[a("ul",e._l(e.picturesUrl,function(t){return a("li",[a("v-touch",{staticClass:"image",style:{"background-image":"url("+t+")"},attrs:{tag:"div"},on:{doubletap:function(t){e.like(t)}}})],1)})),e._v(" "),a("footer-menu")],1)},staticRenderFns:[]}},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("main",[a("div",{staticClass:"container"},[a("a",{staticClass:"icon-arrow-left2 arrow",on:{click:e.flowPage}}),e._v(" "),a("h1",[e._v(e._s(e.user.displayName))]),e._v(" "),a("div",{staticClass:"cardGlobal"},e._l(e.myPhoto,function(t){return a("div",{staticClass:"containerCard",class:[t.pushId]},[a("div",{staticClass:"photo-card"},[a("div",{staticClass:"image",style:{"background-image":"url("+t.url+")"}}),e._v(" "),a("div",{staticClass:"heading"},[a("h2",{staticClass:"title"},[e._v("like : "+e._s(t.like))]),e._v(" "),a("a",{staticClass:"icon-x close",class:[t.pushId],on:{click:function(t){e.removePhoto(t)}}})])])])}))]),e._v(" "),a("footer",[a("nav",[a("ul",[a("li",{staticClass:"icon-photo",attrs:{id:"profil"}},[a("input",{staticClass:"input-file ",attrs:{type:"file"},on:{change:e.onFileChange}})]),e._v(" "),a("li",{attrs:{id:"photo_icon"}})])])])])])},staticRenderFns:[]}}],[14]);
//# sourceMappingURL=app.8c39691aaa32a6cf21c7.js.map